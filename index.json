{
  "index.html": {
    "href": "index.html",
    "title": "cotopaxi",
    "summary": "cotopaxi About A toolset for deploying data to Azure Cosmos DB as part of a cloud-native application, designed for straightforward integration with CI/CD pipelines. The package format is based on Microsoft Common Data Model (CDM) and ECMA-376 (Open Packaging Conventions). flowchart LR s1[/\"JSON<br />documents\"/] s2[[\"cotopaxi<br />pack\"]] s3[/\"CDM<br />package\"/] s4[[\"cotopaxi<br />deploy\"]] s5[(\"Azure<br />Cosmos DB\")] s1-->s2-->s3-->s4-->s5 classDef default stroke-width: 3px, font-family: system-ui Packing the database documents specified in a database package project (an example with Azure Pipelines): $ dotnet tool run cotopaxi pack $(Build.SourcesDirectory)/adventureworks.json $(Build.StagingDirectory)/adventureworks.cdbpkg /home/vsts/work/1/s/adventureworks/products/bikes.json:$[0]: upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75 (4) /home/vsts/work/1/s/adventureworks/products/bikes.json:$[1]: upsert /adventureworks/products/e1894e24-550d-4fe3-9784-47d614600baa (4) Deploying the created database package to a configured Azure Cosmos DB account (an example with Azure Pipelines): $ dotnet tool run cotopaxi deploy $(System.ArtifactsDirectory)/**/*.cdbpkg /home/vsts/work/r1/a/adventureworks.cdbpkg >>> https://adventureworks.documents.azure.com:443 upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"]: HTTP 200 (6.67 RU) upsert /adventureworks/products/e1894e24-550d-4fe3-9784-47d614600baa:[\"bikes\"]: HTTP 200 (6.67 RU) References Microsoft - Common Data Model ECMA International - ECMA-376"
  },
  "topics/cli-checkpoint.html": {
    "href": "topics/cli-checkpoint.html",
    "title": "cotopaxi checkpoint",
    "summary": "cotopaxi checkpoint Name cotopaxi checkpoint - Creates a database package with rollback operations. Synopsis cotopaxi checkpoint <package> <rollback-package> [--endpoint <endpoint> --key <key>|--connection-string <connection-string>] cotopaxi checkpoint -h|--help Description Deploy Operation Rollback Operation Condition delete N/A The document does not exist in the container delete upsert The document does exist in the container create delete The document does not exist in the container create N/A The document does exist in the container upsert delete The document does not exist in the container upsert upsert The document does exist in the container patch N/A The document does not exist in the container patch upsert The document does exist in the container Arguments package The path to the database package or packages for deployment to the Azure Cosmos DB account (globbing patterns are supported). rollback-package The path to a resulting database package with rollback operations. Options --endpoint <endpoint> The address of the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_ENDPOINT environment variable. Must be used with --key option or AZURE_COSMOS_KEY environment variable. --key <key> The account key or resource token for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_KEY environment variable. Must be used with --endpoint option or AZURE_COSMOS_ENDPOINT environment variable. --connection-string <connection-string> The connection string for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_CONNECTION_STRING environment variable. -h|--help Show help and usage information. Examples Creating a rollback package with Azure Pipelines using a read-only account key: - script: > dotnet tool run cotopaxi checkpoint $(System.ArtifactsDirectory)/**/*.cdbpkg $(System.ArtifactsDirectory)/adventureworks.rb.cdbpkg --endpoint $(AZURE_COSMOS_ENDPOINT) --key $(AZURE_COSMOS_KEY_READ_ONLY) /home/vsts/work/r1/a/adventureworks-v1.0.1.cdbpkg + https://adventureworks.documents.azure.com:443 >>> /home/vsts/work/r1/a/adventureworks.rb.cdbpkg read /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"]: HTTP 200 (1.00 RU) read /adventureworks/products/e1894e24-550d-4fe3-9784-47d614600baa:[\"bikes\"]: HTTP 200 (1.00 RU) read /adventureworks/products/7f1b7c5a-c339-41e3-bc00-bc753b1d66bc:[\"bikes\"]: HTTP 404 (1.00 RU) +++ delete /adventureworks/products/7f1b7c5a-c339-41e3-bc00-bc753b1d66bc:[\"bikes\"] (4) +++ upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"] (4) References Microsoft - Azure Cosmos DB service quotas"
  },
  "topics/cli-deploy.html": {
    "href": "topics/cli-deploy.html",
    "title": "cotopaxi deploy",
    "summary": "cotopaxi deploy Name cotopaxi deploy - Deploys the database packages to the Azure Cosmos DB account. Synopsis cotopaxi deploy <package> [--endpoint <endpoint> --key <key>|--connection-string <connection-string>] [--profile <profile>] [--dry-run] cotopaxi deploy -h|--help Description The command uses a connection to the Azure Cosmos DB account to get partition keys configuration for regular and \"dry run\" modes. The operations on the same document defined by a unique identifier and partition key values are executed in the following order: Delete a document if it exists Create a document if it does not exist Upsert a document Patch a document if it exists Arguments package The path to the database package or packages to deploy to the Azure Cosmos DB account (globbing patterns are supported). Options --endpoint <endpoint> The address of the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_ENDPOINT environment variable. Must be used with --key option or AZURE_COSMOS_KEY environment variable. --key <key> The account key or resource token for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_KEY environment variable. Must be used with --endpoint option or AZURE_COSMOS_ENDPOINT environment variable. --connection-string <connection-string> The connection string for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_CONNECTION_STRING environment variable. --profile The path to the deployment profile or profiles that specify documents eligible for updates, based on schema profile.schema.json (globbing patterns are supported). --dry-run Show which operations would be executed instead of actually executing them. -h|--help Show help and usage information. Examples Deploying with Azure Pipelines: - script: > dotnet tool run cotopaxi deploy $(System.ArtifactsDirectory)/**/*.cdbpkg --endpoint $(AZURE_COSMOS_ENDPOINT) --key $(AZURE_COSMOS_KEY) /home/vsts/work/r1/a/adventureworks-v1.0.0.cdbpkg >>> https://adventureworks.documents.azure.com:443 upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"]: HTTP 200 (6.67 RU) upsert /adventureworks/products/e1894e24-550d-4fe3-9784-47d614600baa:[\"bikes\"]: HTTP 200 (6.67 RU) Deploying with Azure Pipelines using a deployment profile: - script: > dotnet tool run cotopaxi deploy $(System.ArtifactsDirectory)/**/*.cdbpkg --endpoint $(AZURE_COSMOS_ENDPOINT) --key $(AZURE_COSMOS_KEY) --profile $(System.ArtifactsDirectory)/**/*.profile.json /home/vsts/work/r1/a/adventureworks-v1.0.0.cdbpkg >>> https://adventureworks.documents.azure.com:443 upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"]: HTTP 200 (6.67 RU) The corresponding deployment profile adventureworks-v1.0.0.profile.json: [ { \"databaseName\": \"adventureworks\", \"containerName\": \"products\", \"documentId\": \"3202cb6f-42af-4fe6-a3c5-d61927721e75\", \"documentPartitionKey\": [ \"bikes\" ] } ] Deploying with Azure Pipelines in dry run mode using a read-only account key: - script: > dotnet tool run cotopaxi deploy $(System.ArtifactsDirectory)/**/*.cdbpkg --endpoint $(AZURE_COSMOS_ENDPOINT) --key $(AZURE_COSMOS_KEY_READ_ONLY) --dry-run [dry-run] /home/vsts/work/r1/a/adventureworks-v1.0.0.cdbpkg >>> https://adventureworks.documents.azure.com:443 [dry-run] upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"]: HTTP ??? (?.?? RU) [dry-run] upsert /adventureworks/products/e1894e24-550d-4fe3-9784-47d614600baa:[\"bikes\"]: HTTP ??? (?.?? RU) References Microsoft - Azure Cosmos DB service quotas"
  },
  "topics/cli-diff.html": {
    "href": "topics/cli-diff.html",
    "title": "cotopaxi diff",
    "summary": "cotopaxi diff Name cotopaxi diff - Shows differences between database packages. Synopsis cotopaxi diff <package1> <package2> [--endpoint <endpoint> --key <key>|--connection-string <connection-string>] [--profile <profile>] [--exit-code] cotopaxi diff -h|--help Description The command uses a connection to the Azure Cosmos DB account to get partition keys configuration. Arguments package1 The path to the database package to compare. package2 The path to the database package to compare with. Options --endpoint <endpoint> The address of the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_ENDPOINT environment variable. Must be used with --key option or AZURE_COSMOS_KEY environment variable. --key <key> The account key or resource token for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_KEY environment variable. Must be used with --endpoint option or AZURE_COSMOS_ENDPOINT environment variable. --connection-string <connection-string> The connection string for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_CONNECTION_STRING environment variable. --profile The path to the deployment profile to generate based on new and modified documents, which can be used with deploy command. The option automatically discards --exit-code instruction. --exit-code Instruct the program to exit with 1 if there were differences and 0 otherwise. -h|--help Show help and usage information. Examples Showing changes in a new version: dotnet tool run cotopaxi diff adventureworks-v1.0.1.cdbpkg adventureworks-v1.0.0.cdbpkg +++ upsert /adventureworks/products/7f1b7c5a-c339-41e3-bc00-bc753b1d66bc:[\"bikes\"] (+4) *** upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"] (*1) Showing changes in a new version and generating a deployment profile based on changes: dotnet tool run cotopaxi diff adventureworks-v1.0.1.cdbpkg adventureworks-v1.0.0.cdbpkg --profile adventureworks-v1.0.1.profile.json +++ upsert /adventureworks/products/7f1b7c5a-c339-41e3-bc00-bc753b1d66bc:[\"bikes\"] (+4) *** upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"] (*1)"
  },
  "topics/cli-format.html": {
    "href": "topics/cli-format.html",
    "title": "cotopaxi format",
    "summary": "cotopaxi format Name cotopaxi format - Formats and prunes the sources with deployment entries. Synopsis cotopaxi format <source> cotopaxi format -h|--help Description The command formats sources, removes comments and the system properties: _etag, _rid, _self, _ts. Arguments source The path to a source or sources with deployment entries to format and prune (globbing patterns are supported). Options -h|--help Show help and usage information. Examples Formatting a source file: dotnet tool run cotopaxi format adventureworks/products/bikes.json /home/vsts/work/1/s/adventureworks/products/bikes.json:$[0]: OK /home/vsts/work/1/s/adventureworks/products/bikes.json:$[1]: OK Formatting all source files: dotnet tool run cotopaxi format adventureworks/**/*.json /home/vsts/work/1/s/adventureworks/products/bikes.json:$[0]: OK /home/vsts/work/1/s/adventureworks/products/bikes.json:$[1]: OK References Microsoft - Azure Cosmos DB documents"
  },
  "topics/cli-pack.html": {
    "href": "topics/cli-pack.html",
    "title": "cotopaxi pack",
    "summary": "cotopaxi pack Name cotopaxi pack - Packs the deployment entries into a database package. Synopsis cotopaxi pack <project> <package> [--version <version>] cotopaxi pack -h|--help Description The package format supports the following deployment operations: create Given a unique identifier and partition key values, creates a document if it does not exist. upsert Given a unique identifier and partition key values, creates a document if it does not exist, or update if it exists. patch Given a unique identifier and partition key values, performs partial document update if it exists. delete Given a unique identifier and partition key values, deletes a document if it exists. Partial document update performs Azure Cosmos DB Set operation on specified root-level document properties. The project format supports relative globbing patterns and the following variables in document paths: Name Value Version The value specified with the --version <version> option A documents file must be a JSON array of objects, where each object has the id property and partition key properties specified. Arguments project The path to the project that specifies deployment entries to include, based on schema project.schema.json. package The path to a resulting database package. Options --version <version> Sets the package version information. -h|--help Show help and usage information. Examples Packing with Azure Pipelines: - script: > dotnet tool run cotopaxi pack $(Build.SourcesDirectory)/adventureworks.json $(Build.StagingDirectory)/adventureworks-v$(ADVENTUREWORKS_VERSION).cdbpkg --version $(ADVENTUREWORKS_VERSION) /home/vsts/work/1/s/adventureworks/products/bikes.json:$[0]: upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75 (4) /home/vsts/work/1/s/adventureworks/products/bikes.json:$[1]: upsert /adventureworks/products/e1894e24-550d-4fe3-9784-47d614600baa (4) The corresponding package source adventureworks/products/bikes.json: [ { \"id\": \"3202cb6f-42af-4fe6-a3c5-d61927721e75\", \"category\": \"bikes\", \"name\": \"Mountain-100 Silver, 38\", \"price\": 4000.0 }, { \"id\": \"e1894e24-550d-4fe3-9784-47d614600baa\", \"category\": \"bikes\", \"name\": \"Mountain-500 Black, 40\", \"price\": 4100.0 } ] The corresponding package project adventureworks.json: { \"databases\": [ { \"name\": \"adventureworks\", \"containers\": [ { \"name\": \"products\", \"operations\": [ { \"name\": \"upsert\", \"documents\": [ \"adventureworks/products/**/*.json\", \"adventureworks/products/**/*-v$(Version).json\" ] } ] } ] } ] } References Microsoft - Partial document update in Azure Cosmos DB Microsoft - Azure Cosmos DB service quotas"
  },
  "topics/cli-show.html": {
    "href": "topics/cli-show.html",
    "title": "cotopaxi show",
    "summary": "cotopaxi show Name cotopaxi show - Shows information about a database package. Synopsis cotopaxi show <package> cotopaxi show -h|--help Arguments package The path to the database package to show information about. Options -h|--help Show help and usage information. Examples Showing information about a database package: dotnet tool run cotopaxi show adventureworks-v1.0.0.cdbpkg cdbpkg:properties:uuid: 0196f43b-4a47-7207-a702-2ef28659cd1a cdbpkg:properties:version: 1.0.0 cdbpkg:properties:subject: cdbpkg:properties:created: 2025-05-04T00:00:08.5198965Z cdbpkg:properties:creator: cotopaxi/1.0.0 cdbpkg:/cosmosdb.document/0196f43b-498e-7098-a28d-1e7d0e44e9dd.json:$[0]: upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75 (4) cdbpkg:/cosmosdb.document/0196f43b-498e-7098-a28d-1e7d0e44e9dd.json:$[1]: upsert /adventureworks/products/e1894e24-550d-4fe3-9784-47d614600baa (4)"
  },
  "topics/cli-snapshot.html": {
    "href": "topics/cli-snapshot.html",
    "title": "cotopaxi snapshot",
    "summary": "cotopaxi snapshot Name cotopaxi snapshot - Creates a database package from the Azure Cosmos DB account. Synopsis cotopaxi snapshot <profile> <package> [--endpoint <endpoint> --key <key>|--connection-string <connection-string>] cotopaxi snapshot -h|--help Description The snapshots of existing documents are added to the resulting database package as upsert operations. Arguments profile The path to the deployment profile or profiles that specify which documents to take snapshots of (globbing patterns are supported). package The path to a resulting database package with import operations. Options --endpoint <endpoint> The address of the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_ENDPOINT environment variable. Must be used with --key option or AZURE_COSMOS_KEY environment variable. --key <key> The account key or resource token for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_KEY environment variable. Must be used with --endpoint option or AZURE_COSMOS_ENDPOINT environment variable. --connection-string <connection-string> The connection string for the Azure Cosmos DB account. Can be specified with AZURE_COSMOS_CONNECTION_STRING environment variable. -h|--help Show help and usage information. Examples Creating a snapshot package with Azure Pipelines using a read-only account key: - script: > dotnet tool run cotopaxi snapshot $(System.ArtifactsDirectory)/**/*.profile.json $(System.ArtifactsDirectory)/adventureworks.sn.cdbpkg --endpoint $(AZURE_COSMOS_ENDPOINT) --key $(AZURE_COSMOS_KEY_READ_ONLY) https://adventureworks.documents.azure.com:443 >>> /home/vsts/work/r1/a/adventureworks.sn.cdbpkg read /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"]: HTTP 200 (1.00 RU) read /adventureworks/products/7f1b7c5a-c339-41e3-bc00-bc753b1d66bc:[\"bikes\"]: HTTP 404 (1.00 RU) +++ upsert /adventureworks/products/3202cb6f-42af-4fe6-a3c5-d61927721e75:[\"bikes\"] (4) The corresponding deployment profile adventureworks.profile.json: [ { \"databaseName\": \"adventureworks\", \"containerName\": \"products\", \"documentId\": \"3202cb6f-42af-4fe6-a3c5-d61927721e75\", \"documentPartitionKey\": [ \"bikes\" ] }, { \"databaseName\": \"adventureworks\", \"containerName\": \"products\", \"documentId\": \"7f1b7c5a-c339-41e3-bc00-bc753b1d66bc\", \"documentPartitionKey\": [ \"bikes\" ] } ]"
  }
}